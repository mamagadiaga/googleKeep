<!--  -->



<script>


    function updateLocalStorageAndUI() {
        let jsonStr = JSON.stringify(notesArray);
        localStorage.setItem("notes", jsonStr);
        updateNotes();
    }

    $("#" + id).find(".edit-note").click(function (event) {
        event.stopPropagation();

        let note = notesArray.find(note => note.Index === id);

        $("#edit-title").val(note.Title);
        $("#edit-content").val(note.Content);

        openEditModal(id);
    });


    $("#" + id).find(".edit-note").click(function (event) {
        event.stopPropagation();

        let note = notesArray.find(note => note.Index === id);

        $("#edit-title").val(note.Title);
        $("#edit-content").val(note.Content);

        openEditModal();

        $("#saveEdit").off("click").on("click", function () {
            let editedTitle = $("#edit-title").val();
            let editedContent = $("#edit-content").val();

            notesArray.push({
                Index: id,
                Color: note.BackgroundColor,
                Title: editedTitle,
                Content: editedContent,
                BackgroundColor: note.BackgroundColor,
                ImageURL: note.ImageURL,
            });

            updateLocalStorageAndUI();

            closeEditModal();
        });
    });
    
    function saveEdit() {
        var editedTitle = $("#edit-title").val();
        var editedContent = $("#edit-content").val();

        var id = $("#editModal").data("note-id");

        var noteIndex = notesArray.findIndex(note => note.Index === id);
        if (noteIndex !== -1) {
            notesArray[noteIndex].Title = editedTitle;
            notesArray[noteIndex].Content = editedContent;
        }

        updateLocalStorageAndUI();

        closeEditModal();
    }
    function openEditModal(id) {
        $("#editModal").data("note-id", id);

        document.getElementById("editModal").style.display = "block";
    }


</script>